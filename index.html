<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CAPLUS 네트워킹 데이 럭키드로우</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Black+Han+Sans&family=Noto+Sans+KR:wght@400;700&display=swap');

        body {
            font-family: 'Noto+Sans+KR', sans-serif;
            background: radial-gradient(circle, #1e1e2f 0%, #0d0d15 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            margin: 0;
            overflow: hidden;
        }

        .title-font {
            font-family: 'Black+Han+Sans', sans-serif;
            text-shadow: 0 0 20px rgba(78, 205, 196, 0.5);
        }

        /* 슬롯 머신 기기 스타일 */
        .slot-machine {
            background: linear-gradient(180deg, #444 0%, #222 100%);
            border: 10px solid #ffd700;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 0 50px rgba(0,0,0,0.8), inset 0 0 20px rgba(255,215,0,0.2);
            position: relative;
        }

        .slot-display {
            background: #000;
            border-radius: 10px;
            display: flex;
            gap: 15px;
            padding: 20px;
            border: 4px solid #333;
        }

        .slot-reel {
            width: 100px;
            height: 150px;
            background: #fff;
            border-radius: 8px;
            overflow: hidden;
            position: relative;
            box-shadow: inset 0 0 15px rgba(0,0,0,0.5);
        }

        .reel-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            transition: transform 0.1s linear;
        }

        .slot-number {
            height: 150px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 80px;
            font-weight: 900;
            color: #333;
            width: 100%;
        }

        .lever {
            position: absolute;
            right: -60px;
            top: 100px;
            width: 20px;
            height: 150px;
            background: #666;
            border-radius: 10px;
            cursor: pointer;
        }

        .lever::after {
            content: '';
            position: absolute;
            top: -30px;
            left: -15px;
            width: 50px;
            height: 50px;
            background: radial-gradient(circle, #ff6b6b, #c0392b);
            border-radius: 50%;
            box-shadow: 0 5px 10px rgba(0,0,0,0.3);
        }

        .lever.active {
            transform: rotateX(45deg);
            transform-origin: bottom;
        }

        /* 오버레이 공통 */
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 100;
            backdrop-filter: blur(10px);
        }

        .modal-card {
            background: white;
            color: #1a1a2e;
            padding: 3rem;
            border-radius: 2rem;
            text-align: center;
            box-shadow: 0 0 50px rgba(255, 255, 255, 0.1);
        }

        .result-card {
            background: linear-gradient(135deg, #ffd700, #ffae00);
            animation: winnerScale 0.5s infinite alternate;
        }

        @keyframes winnerScale {
            from { transform: scale(1); }
            to { transform: scale(1.05); }
        }

        .spin-btn {
            background: linear-gradient(180deg, #ffd700 0%, #ff8c00 100%);
            color: #1a1a2e;
            text-shadow: 0 1px 2px rgba(255,255,255,0.5);
            transition: all 0.2s;
        }

        .spin-btn:disabled {
            background: #444;
            color: #888;
            cursor: not-allowed;
        }

        .glow-text {
            animation: textGlow 2s infinite;
        }

        @keyframes textGlow {
            0%, 100% { color: #fff; text-shadow: 0 0 10px #ffd700; }
            50% { color: #ffd700; text-shadow: 0 0 30px #ff8c00; }
        }
    </style>
</head>
<body>

    <!-- 초기 설정 모달 -->
    <div id="setupOverlay" class="overlay">
        <div class="modal-card max-w-md w-full">
            <h2 class="text-3xl font-bold mb-6">최대 숫자 설정</h2>
            <p class="mb-4 text-gray-600 text-lg">추첨할 마지막 번호를 입력해 주세요.</p>
            <input type="number" id="maxNumberInput" placeholder="예: 32" class="w-full text-3xl p-4 border-4 border-yellow-400 rounded-xl mb-6 text-center focus:outline-none focus:ring-2 ring-yellow-500" min="1" max="99">
            <button onclick="startApp()" class="w-full py-4 bg-yellow-500 hover:bg-yellow-600 text-white text-2xl font-bold rounded-xl transition-all">
                설정 완료
            </button>
        </div>
    </div>

    <div id="mainContent" class="flex flex-col items-center gap-10 p-4 opacity-0 transition-opacity duration-500">
        <div class="text-center">
            <h1 class="text-5xl md:text-6xl title-font glow-text mb-2">CAPLUS</h1>
            <h2 class="text-2xl md:text-3xl font-bold tracking-widest text-gray-300">네트워킹 데이 럭키드로우</h2>
        </div>
        
        <div class="slot-machine">
            <div class="slot-display">
                <div class="slot-reel">
                    <div id="reel1" class="reel-container"></div>
                </div>
                <div class="slot-reel">
                    <div id="reel2" class="reel-container"></div>
                </div>
            </div>
            <div id="lever" class="lever hidden md:block"></div>
        </div>

        <div class="flex flex-col items-center gap-4">
            <button id="spinBtn" class="spin-btn px-16 py-5 rounded-xl text-3xl font-black shadow-2xl">
                럭키드로우 시작!
            </button>
            <div class="bg-black/50 px-8 py-3 rounded-full border border-yellow-500/30">
                <span class="text-yellow-500 font-bold text-xl">남은 인원: <span id="remainingCount" class="text-white">0</span>명</span>
            </div>
        </div>

        <p id="rangeText" class="text-yellow-500 font-bold">1번부터 00번까지의 주인공은?</p>
    </div>

    <!-- 결과 표시 레이어 -->
    <div id="resultOverlay" class="overlay" style="display: none;">
        <div class="modal-card result-card">
            <h2 class="text-3xl font-bold mb-4">축하합니다!</h2>
            <p class="text-xl mb-2">당첨 번호</p>
            <div id="resultNumber" class="text-9xl font-black mb-6">00</div>
            <button onclick="closeResult()" class="px-10 py-3 bg-black text-white rounded-full font-bold text-xl hover:bg-gray-800 transition-colors">
                다음 추첨하기
            </button>
        </div>
    </div>

    <script>
        const setupOverlay = document.getElementById('setupOverlay');
        const mainContent = document.getElementById('mainContent');
        const reel1 = document.getElementById('reel1');
        const reel2 = document.getElementById('reel2');
        const spinBtn = document.getElementById('spinBtn');
        const lever = document.getElementById('lever');
        const resultOverlay = document.getElementById('resultOverlay');
        const resultNumber = document.getElementById('resultNumber');
        const remainingCountDisplay = document.getElementById('remainingCount');
        const rangeText = document.getElementById('rangeText');

        let isSpinning = false;
        let numbersPool = [];
        let maxNumber = 0;
        const reelCount = 20;

        // 앱 시작 및 초기화
        function startApp() {
            const input = document.getElementById('maxNumberInput');
            maxNumber = parseInt(input.value);

            if (!maxNumber || maxNumber < 1) {
                alert("1 이상의 숫자를 입력해 주세요.");
                return;
            }

            if (maxNumber > 99) {
                alert("최대 99까지만 가능합니다.");
                return;
            }

            // 숫자 풀 생성 (1부터 maxNumber까지)
            numbersPool = Array.from({length: maxNumber}, (_, i) => i + 1);
            
            // UI 업데이트
            remainingCountDisplay.innerText = numbersPool.length;
            rangeText.innerText = `1번부터 ${maxNumber}번까지의 주인공은?`;
            
            setupOverlay.style.display = 'none';
            mainContent.classList.remove('opacity-0');
            initReels();
        }

        // 릴 초기화 (회전 애니메이션용 임시 숫자들)
        function initReels() {
            reel1.innerHTML = '';
            reel2.innerHTML = '';
            for (let i = 0; i < reelCount; i++) {
                const div1 = document.createElement('div');
                div1.className = 'slot-number';
                div1.innerText = Math.floor(Math.random() * 10);
                reel1.appendChild(div1);

                const div2 = document.createElement('div');
                div2.className = 'slot-number';
                div2.innerText = Math.floor(Math.random() * 10);
                reel2.appendChild(div2);
            }
        }

        async function spin() {
            if (isSpinning || numbersPool.length === 0) return;
            
            isSpinning = true;
            spinBtn.disabled = true;
            lever.classList.add('active');
            
            // 랜덤 번호 추출 (동일 확률, 비복원 추출)
            const randomIndex = Math.floor(Math.random() * numbersPool.length);
            const winningNum = numbersPool.splice(randomIndex, 1)[0];
            
            const tens = Math.floor(winningNum / 10);
            const units = winningNum % 10;

            // 마지막 칸에 실제 결과값 삽입
            reel1.lastElementChild.innerText = tens;
            reel2.lastElementChild.innerText = units;

            const duration = 2500;
            const reelHeight = 150;
            const targetPos = -(reelCount - 1) * reelHeight;

            [reel1, reel2].forEach((reel, index) => {
                reel.style.transition = `transform ${duration + (index * 400)}ms cubic-bezier(0.45, 0.05, 0.55, 0.95)`;
                reel.style.transform = `translateY(${targetPos}px)`;
            });

            setTimeout(() => lever.classList.remove('active'), 500);

            setTimeout(() => {
                showResult(winningNum);
                isSpinning = false;
                spinBtn.disabled = numbersPool.length === 0;
                remainingCountDisplay.innerText = numbersPool.length;
                if(numbersPool.length === 0) {
                    spinBtn.innerText = "추첨 종료";
                }
            }, duration + 1000);
        }

        function showResult(num) {
            const formatted = num < 10 ? `0${num}` : num;
            resultNumber.innerText = formatted;
            resultOverlay.style.display = 'flex';
        }

        function closeResult() {
            resultOverlay.style.display = 'none';
            [reel1, reel2].forEach(reel => {
                reel.style.transition = 'none';
                reel.style.transform = 'translateY(0)';
            });
            initReels();
        }

        spinBtn.addEventListener('click', spin);
        lever.addEventListener('click', spin);

        // 엔터키 입력 시 앱 시작
        document.getElementById('maxNumberInput').addEventListener('keypress', (e) => {
            if(e.key === 'Enter') startApp();
        });
    </script>
</body>
</html>
